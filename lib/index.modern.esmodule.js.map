{"version":3,"file":"index.modern.esmodule.js","sources":["../src/resolve-id.js","../src/load-content.js","../src/parse-statements.js","../src/index.js"],"sourcesContent":["import { default as resolveId } from \"resolve\"\nimport { includes } from \"lodash\"\n\nvar moduleDirectories = [\n  \"web_modules\",\n  \"node_modules\"\n]\n\nfunction resolveModule(id, opts)\n{\n  return new Promise((resolve, reject) =>\n  {\n    resolveId(id, opts, (err, path) =>\n      err ? reject(err) : resolve(path)\n    )\n  })\n}\n\nexport default function(id, base, options)\n{\n  var paths = options.path\n\n  var resolveOpts = {\n    basedir: base,\n    moduleDirectory: moduleDirectories,\n    paths: paths,\n    extensions: [ \".css\", \".sss\", \".less\", \".scss\", \".sass\" ],\n    packageFilter: function processPackage(pkg)\n    {\n      if (pkg.style) {\n        pkg.main = pkg.style\n      }\n      else if (pkg.browser) {\n        pkg.main = pkg.browser\n      }\n      else if (!pkg.main || !(/\\.css$/).test(pkg.main)) {\n        pkg.main = \"index.css\"\n      }\n      return pkg\n    }\n  }\n\n  return resolveModule(\"./\" + id, resolveOpts)\n    .catch(() =>\n       resolveModule(id, resolveOpts)\n    )\n    .catch(() => {\n      if (!includes(paths, base)) {\n        paths.unshift(base)\n      }\n\n      throw new Error([\n        \"Failed to find '\" + id + \"'\",\n        \"in [ \",\n        \"    \" + paths.join(\",\\n        \"),\n        \"]\"\n      ].join(\"\\n    \"))\n    })\n}\n","import readCache from \"read-cache\"\n\nexport default function loadContent(fileName) {\n  return readCache(fileName, \"utf-8\")\n}\n","import valueParser from \"postcss-value-parser\"\n\nvar stringify = valueParser.stringify\n\nexport default function parseStatements(result, styles)\n{\n  var statements = []\n  var nodes = []\n\n  styles.each((node) =>\n  {\n    var stmt\n    if (node.type === \"atrule\" && node.name === \"import\")\n      stmt = parseImport(result, node)\n\n    if (stmt)\n    {\n      if (nodes.length > 0)\n      {\n        statements.push({\n          type: \"nodes\",\n          nodes: nodes\n        })\n\n        nodes = []\n      }\n\n      statements.push(stmt)\n    }\n    else\n    {\n      nodes.push(node)\n    }\n  })\n\n  if (nodes.length > 0)\n  {\n    statements.push({\n      type: \"nodes\",\n      nodes: nodes\n    })\n  }\n\n  return statements\n}\n\nfunction parseImport(result, atRule)\n{\n  var prev = atRule.prev()\n  while (prev && prev.type === \"comment\") {\n    prev = prev.prev()\n  }\n\n  if (prev)\n  {\n    if (prev.type !== \"atrule\" || (prev.name !== \"import\" && prev.name !== \"charset\"))\n    {\n      return result.warn(\n        \"@import must precede all other statements (besides @charset)\",\n        { node: atRule }\n      )\n    }\n  }\n\n  if (atRule.nodes)\n  {\n    return result.warn(\n      \"It looks like you didn't end your @import statement correctly. Child nodes are attached to it.\",\n      { node: atRule }\n    )\n  }\n\n  var params = valueParser(atRule.params).nodes\n  var stmt = {\n    type: \"import\",\n    node: atRule\n  }\n\n  if (\n    params.length === 0 ||\n    (\n      params[0].type !== \"string\" ||\n      !params[0].value\n    ) &&\n    (\n      params[0].type !== \"function\" ||\n      params[0].value !== \"url\" ||\n      params[0].nodes.length === 0 ||\n      !params[0].nodes[0].value\n    )\n  ) {\n    return result.warn(\n      \"Unable to find uri in '\" + atRule.toString() + \"'\",\n      { node: atRule }\n    )\n  }\n\n  if (params[0].type === \"string\")\n    stmt.uri = params[0].value\n  else\n    stmt.uri = params[0].nodes[0].value\n\n  stmt.fullUri = stringify(params[0])\n\n  return stmt\n}\n","import path from \"path\"\nimport assign from \"object-assign\"\nimport postcss from \"postcss\"\nimport { get } from \"lodash\"\n\nimport resolveId from \"./resolve-id\"\nimport loadContent from \"./load-content\"\nimport parseStatements from \"./parse-statements\"\nimport promiseEach from \"promise-each\"\n\nvar URL_RE = /^(?:[a-z]+:)?\\/\\//i\n\nfunction SmartImport(options)\n{\n  options = assign({\n    root: process.cwd(),\n    path: [],\n    skipDuplicates: true,\n    resolve: resolveId,\n    load: loadContent,\n    plugins: []\n  }, options)\n\n  options.root = path.resolve(options.root)\n\n  // convert string to an array of a single element\n  if (typeof options.path === \"string\")\n    options.path = [ options.path ]\n\n  if (!Array.isArray(options.path))\n    options.path = []\n\n  options.path = options.path.map((possibleRelativePath) =>\n    path.resolve(options.root, possibleRelativePath)\n  )\n\n  return function(styles, result)\n  {\n    var state = {\n      importedFiles: {},\n      hashFiles: {}\n    }\n\n    var fileName = get(styles, \"source.input.file\")\n    if (fileName)\n      state.importedFiles[fileName] = {}\n\n    if (options.plugins && !Array.isArray(options.plugins))\n      throw new Error(\"plugins option must be an array\")\n\n    return parseStyles(result, styles, options, state, [])\n      .then((bundle) => {\n        applyRaws(bundle)\n        applyStyles(bundle, styles)\n\n        if (typeof options.onImport === \"function\")\n          options.onImport(Object.keys(state.importedFiles))\n      })\n  }\n}\n\nfunction applyRaws(bundle)\n{\n  bundle.forEach((stmt, index) =>\n  {\n    if (index === 0)\n      return\n\n    if (stmt.parent)\n    {\n      var before = stmt.parent.node.raws.before\n      if (stmt.type === \"nodes\")\n        stmt.nodes[0].raws.before = before\n      else\n        stmt.node.raws.before = before\n    }\n    else if (stmt.type === \"nodes\")\n    {\n      stmt.nodes[0].raws.before = stmt.nodes[0].raws.before || \"\\n\"\n    }\n  })\n}\n\nfunction applyStyles(bundle, styles)\n{\n  styles.nodes = []\n\n  bundle.forEach((stmt) =>\n  {\n    if (stmt.type === \"import\")\n    {\n      stmt.node.parent = undefined\n      styles.append(stmt.node)\n    }\n    else if (stmt.type === \"media\")\n    {\n      stmt.node.parent = undefined\n      styles.append(stmt.node)\n    }\n    else if (stmt.type === \"nodes\")\n    {\n      stmt.nodes.forEach((node) => {\n        node.parent = undefined\n        styles.append(node)\n      })\n    }\n  })\n}\n\nfunction parseStyles(result, styles, options, state, media)\n{\n  var statements = parseStatements(result, styles)\n\n  return Promise.resolve(statements).then(promiseEach((stmt) => {\n    // skip protocol base uri (protocol://url) or protocol-relative\n    if (stmt.type !== \"import\" || (!options.resolveUrls && URL_RE.test(stmt.uri)))\n      return null\n    else\n      return resolveImportId(result, stmt, options, state)\n  }))\n    .then(() => {\n      var imports = []\n      var bundle = []\n\n      // squash statements and their children\n      statements.forEach((stmt) =>\n      {\n        if (stmt.type === \"import\")\n        {\n          if (stmt.children)\n          {\n            stmt.children.forEach((child, index) =>\n            {\n              if (child.type === \"import\")\n                imports.push(child)\n              else\n                bundle.push(child)\n\n              // For better output\n              if (index === 0)\n                child.parent = stmt\n            })\n          }\n          else\n          {\n            imports.push(stmt)\n          }\n        }\n        else if (stmt.type === \"media\" || stmt.type === \"nodes\")\n        {\n          bundle.push(stmt)\n        }\n      })\n\n      return imports.concat(bundle)\n    })\n}\n\nfunction resolveImportId(result, stmt, options, state)\n{\n  var atRule = stmt.node\n  var sourceFile = get(atRule, \"source.input.file\")\n  var sourcePath = options.resolveUrls && URL_RE.test(sourceFile) ? sourceFile : path.dirname(sourceFile)\n  var base = sourceFile ? sourcePath : options.root\n\n  return Promise.resolve(options.resolve(stmt.uri, base, options))\n    .then((resolved) => {\n      if (!Array.isArray(resolved))\n        resolved = [ resolved ]\n\n      // Add dependency messages:\n      resolved.forEach((fileName) => {\n        result.messages.push({\n          type: \"dependency\",\n          file: fileName,\n          parent: sourceFile\n        })\n      })\n\n      return Promise.all(resolved.map((file) =>\n         loadImportContent(\n           result,\n           stmt,\n           file,\n           options,\n           state\n        )\n      ))\n    })\n    .then((importedContent) => {\n      // Merge loaded statements\n      stmt.children = importedContent.reduce((currentContent, statements) => {\n        if (statements) {\n          currentContent = currentContent.concat(statements)\n        }\n        return currentContent\n      }, [])\n    })\n    .catch((err) => {\n      result.warn(err.message, { node: atRule })\n    })\n}\n\nfunction loadImportContent(result, stmt, filename, options, state)\n{\n  var atRule = stmt.node\n  if (options.skipDuplicates)\n  {\n    // skip files already imported at the same scope\n    if (state.importedFiles[filename])\n      return null\n\n    // save imported files to skip them next time\n    state.importedFiles[filename] = true\n  }\n\n  return Promise.resolve(options.load(filename, options))\n    .then((content) => {\n      if (typeof options.transform !== \"function\") {\n        return content\n      }\n      return Promise.resolve(options.transform(content, filename, options))\n        .then((transformed) =>\n         typeof transformed === \"string\" ? transformed : content\n      )\n    })\n    .then((content) => {\n      if (content.trim() === \"\")\n      {\n        result.warn(filename + \" is empty\", { node: atRule })\n        return null\n      }\n\n      // skip previous imported files not containing @import rules\n      if (state.hashFiles[content])\n        return null\n\n      return postcss(options.plugins).process(content, {\n        from: filename,\n        syntax: result.opts.syntax,\n        parser: result.opts.parser\n      })\n        .then((importedResult) =>\n        {\n          var styles = importedResult.root\n          result.messages = result.messages.concat(importedResult.messages)\n\n          if (options.skipDuplicates)\n          {\n            var hasImport = styles.some((child) =>\n              child.type === \"atrule\" && child.name === \"import\"\n            )\n\n            if (!hasImport)\n              state.hashFiles[content] = true\n          }\n\n          // recursion: import @import from imported file\n          return parseStyles(result, styles, options, state)\n        })\n    })\n}\n\nexport default postcss.plugin(\"postcss-smart-import\", SmartImport)\n"],"names":["moduleDirectories","resolveModule","id","opts","Promise","resolve","reject","err","path","base","options","paths","resolveOpts","pkg","style","main","browser","test","unshift","Error","join","loadContent","fileName","readCache","stringify","valueParser","parseStatements","result","styles","statements","nodes","each","node","stmt","type","name","parseImport","length","push","atRule","prev","warn","params","value","toString","uri","fullUri","URL_RE","SmartImport","assign","process","cwd","resolveId","root","Array","isArray","map","possibleRelativePath","state","importedFiles","plugins","parseStyles","then","bundle","onImport","Object","keys","applyRaws","forEach","index","parent","before","raws","applyStyles","undefined","append","promiseEach","resolveUrls","resolveImportId","imports","children","child","concat","sourceFile","sourcePath","dirname","resolved","messages","all","file","loadImportContent","importedContent","reduce","currentContent","message","filename","skipDuplicates","load","content","transform","transformed","trim","hashFiles","postcss","syntax","parser","importedResult","hasImport","some","plugin"],"mappings":"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"}